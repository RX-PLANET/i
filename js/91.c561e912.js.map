{"version":3,"file":"js/91.c561e912.js","mappings":"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","sources":["webpack://i/./src/components/account/common/footer.vue","webpack://i/./src/components/account/common/footer.vue?db8a","webpack://i/./src/views/account/email/reset-password.vue","webpack://i/./src/views/account/email/reset-password.vue?cb21"],"sourcesContent":["<template>\n    <footer class=\"m-footer\">© RX-PLANET</footer>\n</template>\n\n<script>\nexport default {\n    name: \"RX-Footer\",\n    props: [],\n    components: {},\n    data: function () {\n        return {};\n    },\n    computed: {},\n    watch: {},\n    methods: {},\n    created: function () {},\n    mounted: function () {},\n};\n</script>\n\n<style lang=\"less\">\n.m-footer {\n    padding: 10px 0;\n    text-align: center;\n    font-size: 12px;\n    letter-spacing: 0.5px;\n    color: #999;\n    font-family: \"Trebuchet MS\", \"Lucida Sans Unicode\", \"Lucida Grande\", \"Lucida Sans\", Arial, sans-serif;\n}\n</style>\n","import { render } from \"./footer.vue?vue&type=template&id=f8199eda\"\nimport script from \"./footer.vue?vue&type=script&lang=js\"\nexport * from \"./footer.vue?vue&type=script&lang=js\"\n\nimport \"./footer.vue?vue&type=style&index=0&id=f8199eda&lang=less\"\n\nimport exportComponent from \"/home/runner/work/i/i/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","<template>\n    <div class=\"p-account p-reset-password\">\n        <el-row class=\"m-container\" justify=\"center\">\n            <div class=\"m-reset-password\">\n                <logo :app=\"app\" />\n                <div class=\"m-card\">\n                    <card-header :title=\"$t('account.email.resetPassword')\"></card-header>\n                    <div class=\"m-card-main\" v-if=\"step != 3\">\n                        <el-form\n                            class=\"m-card-form\"\n                            :model=\"form\"\n                            ref=\"resetForm\"\n                            label-position=\"top\"\n                            hide-required-asterisk\n                            :rules=\"rules\"\n                            size=\"large\"\n                        >\n                            <p class=\"u-tips\" v-if=\"step == 0\">🌟 {{ $t(\"account.email.findPassword\") }}</p>\n                            <el-form-item prop=\"email\">\n                                <template #label>\n                                    <div class=\"m-card-form-label\">\n                                        <span>{{ $t(\"account.email.address\") }}</span>\n                                    </div>\n                                </template>\n                                <div class=\"m-reset-password__email\">\n                                    <el-input\n                                        v-model.trim=\"form.email\"\n                                        :disabled=\"step != 0\"\n                                        size=\"large\"\n                                        placeholder=\"yourname@example.com\"\n                                    >\n                                    </el-input>\n                                    <el-button v-if=\"sent\" class=\"u-btn\" type=\"primary\" plain @click=\"resetPwd\"\n                                        >{{ $t(\"account.email.resend\") }}\n                                        <template v-if=\"interval\"\n                                            >(<span>{{ interval }}s</span>)\n                                        </template></el-button\n                                    >\n                                </div>\n                            </el-form-item>\n                            <template v-if=\"step == 1\">\n                                <el-form-item prop=\"code\">\n                                    <template #label>\n                                        <div class=\"m-card-form-label\">\n                                            <span>{{ $t(\"account.email.code\") }}</span>\n                                        </div>\n                                    </template>\n                                    <el-input\n                                        v-model.trim=\"form.code\"\n                                        size=\"large\"\n                                        :placeholder=\"$t('account.email.code')\"\n                                    >\n                                    </el-input>\n                                </el-form-item>\n                                <el-form-item prop=\"password1\">\n                                    <template #label>\n                                        <div class=\"m-card-form-label\">\n                                            <span>{{ $t(\"account.email.newPassword\") }}</span>\n                                        </div>\n                                    </template>\n                                    <el-input\n                                        v-model.trim=\"form.password1\"\n                                        type=\"password\"\n                                        size=\"large\"\n                                        show-password\n                                        :placeholder=\"$t('account.email.newPassword')\"\n                                    >\n                                    </el-input>\n                                </el-form-item>\n                                <el-form-item prop=\"password2\">\n                                    <template #label>\n                                        <div class=\"m-card-form-label\">\n                                            <span>{{ $t(\"account.email.confirmPassword\") }}</span>\n                                        </div>\n                                    </template>\n                                    <el-input\n                                        v-model.trim=\"form.password2\"\n                                        type=\"password\"\n                                        size=\"large\"\n                                        show-password\n                                        :placeholder=\"$t('account.email.confirmPassword')\"\n                                    >\n                                    </el-input>\n                                </el-form-item>\n                            </template>\n                            <el-form-item>\n                                <el-button class=\"u-button u-submit\" type=\"primary\" @click=\"onNextStep\">{{\n                                    $t(\"account.email.next\")\n                                }}</el-button>\n                            </el-form-item>\n                        </el-form>\n                    </div>\n\n                    <!-- 重置完成 -->\n                    <main class=\"m-card-main\" v-if=\"step == 3\">\n                        <el-alert\n                            class=\"m-alert\"\n                            :title=\"$t('account.email.resetSuccess')\"\n                            type=\"success\"\n                            :description=\"$t('account.email.resetSuccessDesc')\"\n                            show-icon\n                            :closable=\"false\"\n                        >\n                        </el-alert>\n                        <a class=\"u-skip el-button u-btn el-button--primary\" :href=\"loginLink\">{{\n                            $t(\"account.common.login\")\n                        }}</a>\n                    </main>\n                </div>\n\n                <div class=\"m-footer\">\n                    <div class=\"m-footer-skip\">\n                        <a class=\"u-link\" :href=\"loginLink\"\n                            >← {{ $t(\"account.common.back\") + $t(\"account.common.login\") }}</a\n                        >\n                    </div>\n                </div>\n            </div>\n        </el-row>\n        <Footer />\n    </div>\n</template>\n\n<script>\nimport { checkEmail, findPassword, resetPassword } from \"@/service/account\";\nimport Footer from \"@/components/account/common/footer.vue\";\nexport default {\n    name: \"ResetPassword\",\n    components: {\n        Footer,\n    },\n    data() {\n        return {\n            form: {\n                email: \"\",\n            },\n\n            rules: {\n                email: [\n                    { required: true, message: this.$t(\"account.email.addressPlaceholder\"), trigger: \"blur\" },\n                    { type: \"email\", message: this.$t(\"account.email.addressError\"), trigger: \"blur\" },\n                    { validator: this.check, trigger: \"blur\" },\n                ],\n                code: [\n                    // 数字与大写字母组合\n                    { required: true, message: \"请输入验证码\", trigger: \"blur\" },\n                    { pattern: /^[0-9A-Z]+$/, message: \"验证码格式错误\", trigger: \"blur\" },\n                ],\n                // password1和password2必须相同，且均在6-30位之间\n                password1: [\n                    { required: true, message: this.$t(\"account.common.passwordPlaceholder\"), trigger: \"blur\" },\n                    { min: 6, max: 30, message: this.$t(\"account.common.passwordError\"), trigger: \"blur\" },\n                ],\n                password2: [\n                    { required: true, message: this.$t(\"account.common.password2Placeholder\"), trigger: \"blur\" },\n                    { min: 6, max: 30, message: this.$t(\"account.common.passwordError\"), trigger: \"blur\" },\n                    {\n                        validator: (rule, value, callback) => {\n                            if (value !== this.form.password1) {\n                                callback(new Error(this.$t(\"account.common.passwordError2\")));\n                            } else {\n                                callback();\n                            }\n                        },\n                        trigger: \"blur\",\n                    },\n                ],\n            },\n\n            timer: null,\n            interval: 0,\n            app: \"\",\n            sent: false,\n            step: 0,\n        };\n    },\n    computed: {\n        loginLink() {\n            const path = this.$router.resolve({ name: \"email-login\", query: { app: this.app } });\n            return path.href;\n        },\n    },\n    mounted() {\n        const search = new URLSearchParams(location.search);\n        this.app = search.get(\"app\") || \"miipet\";\n\n        if (this.timer) {\n            clearInterval(this.timer);\n            this.timer = null;\n            this.interval = 10;\n        }\n    },\n    methods: {\n        async check(rule, value, callback) {\n            if (!value) {\n                callback(new Error(\"请输入邮箱地址\"));\n            } else {\n                const res = await checkEmail(value);\n                if (!res) {\n                    callback(new Error(\"邮箱地址不存在\"));\n                }\n                callback();\n            }\n        },\n        onNextStep() {\n            if (this.step == 0) {\n                // 发送验证码\n                this.sendCode();\n            }\n\n            if (this.step == 1) {\n                // 重置密码\n                this.resetPwd();\n            }\n        },\n        sendCode() {\n            this.$refs.resetForm.validate(async (valid) => {\n                if (valid) {\n                    findPassword({ email: this.form.email }, { app: this.app }).then(() => {\n                        this.$message.success(this.$t(\"account.email.sendResetSuccess\"));\n                        this.sent = true;\n                        this.step = 1;\n                        // 定时180s才能再次发送\n                        this.interval = 10;\n                        this.timer = setInterval(() => {\n                            this.interval--;\n                            if (this.interval <= 0) {\n                                clearInterval(this.timer);\n                                this.timer = null;\n                            }\n                        }, 1000);\n                    });\n                }\n            });\n        },\n        resetPwd() {\n            this.$refs.resetForm.validate(async (valid) => {\n                if (valid) {\n                    const data = {\n                        email: this.form.email,\n                        code: this.form.code,\n                        password: this.form.password1,\n                    };\n                    resetPassword(data, { app: this.app }).then(() => {\n                        this.$message.success(this.$t(\"account.email.resetSuccessDesc\"));\n                        this.step = 3;\n                    });\n                }\n            });\n        },\n    },\n};\n</script>\n\n<style lang=\"less\">\n@import \"@/assets/css/account/common.less\";\n@import \"@/assets/css/account/email/forgot.less\";\n</style>\n","import { render } from \"./reset-password.vue?vue&type=template&id=b4180d8e\"\nimport script from \"./reset-password.vue?vue&type=script&lang=js\"\nexport * from \"./reset-password.vue?vue&type=script&lang=js\"\n\nimport \"./reset-password.vue?vue&type=style&index=0&id=b4180d8e&lang=less\"\n\nimport exportComponent from \"/home/runner/work/i/i/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["class","_createElementBlock","name","props","components","data","computed","watch","methods","created","mounted","__exports__","render","_createVNode","_component_el_row","justify","_createElementVNode","_component_logo","app","$data","_component_card_header","title","_ctx","_component_el_form","model","ref","rules","size","_toDisplayString","_component_el_form_item","prop","label","_component_el_input","email","$event","trim","disabled","placeholder","_createBlock","_component_el_button","type","plain","onClick","$options","_Fragment","key","code","password1","password2","_component_el_alert","description","closable","href","_hoisted_12","_hoisted_15","_component_Footer","Footer","form","required","message","this","$t","trigger","validator","check","pattern","min","max","rule","value","callback","Error","timer","interval","sent","step","loginLink","path","$router","resolve","query","search","URLSearchParams","location","get","clearInterval","async","res","checkEmail","onNextStep","sendCode","resetPwd","$refs","resetForm","validate","valid","findPassword","then","$message","success","setInterval","password","resetPassword"],"sourceRoot":""}