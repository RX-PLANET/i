"use strict";(self["webpackChunki"]=self["webpackChunki"]||[]).push([[156],{2208:function(e,t,n){n.d(t,{CD:function(){return c},Cs:function(){return a},Je:function(){return l},UP:function(){return u},aH:function(){return r},fD:function(){return s},tW:function(){return i}});var o=n(6102);async function r(e){return(0,o.VM)().get("/api/uc/user/account/phone/valid",{params:{phone:e}}).then((e=>{var t;return null===(t=e.data.data)||void 0===t?void 0:t.isExist}))}function c(e,t){return(0,o.VM)().post("/api/uc/user/account/phone/register",e,{params:t})}async function i(e){return(0,o.VM)().get("/api/uc/user/account/phone/check-code",{params:e})}function s(e,t){return(0,o.VM)().post("/api/uc/user/account/phone/active",e,{params:t})}function a(e,t){return(0,o.VM)().post("/api/uc/user/account/phone/login",e,{params:t})}function u(e,t){return(0,o.VM)().post("/api/uc/user/account/phone/login/code-send",e,{params:t})}function l(e,t){return(0,o.VM)().post("/api/uc/user/account/phone/login/code-verify",e,{params:t})}},650:function(e,t,n){n.d(t,{Z:function(){return u}});var o=n(6252);const r={class:"m-footer"};function c(e,t,n,c,i,s){return(0,o.wg)(),(0,o.iD)("footer",r,"Â© RX-PLANET")}var i={name:"RX-Footer",props:[],components:{},data:function(){return{}},computed:{},watch:{},methods:{},created:function(){},mounted:function(){}},s=n(3744);const a=(0,s.Z)(i,[["render",c]]);var u=a},6156:function(e,t,n){n.r(t),n.d(t,{default:function(){return M}});var o=n(6252);const r={class:"p-account p-account-phone--login"},c={class:"m-login"};function i(e,t,n,i,s,a){const u=(0,o.up)("logo"),l=(0,o.up)("login"),d=(0,o.up)("el-row"),p=(0,o.up)("Footer");return(0,o.wg)(),(0,o.iD)("div",r,[(0,o.Wm)(d,{class:"m-container",justify:"center"},{default:(0,o.w5)((()=>[(0,o._)("div",c,[(0,o.Wm)(u,{app:s.app},null,8,["app"]),(0,o.Wm)(l,{app:s.app,registerLink:a.registerLink,resetPwdLink:a.resetPwdLink},null,8,["app","registerLink","resetPwdLink"])])])),_:1}),(0,o.Wm)(p)])}var s=n(3577),a=n(9963);const u={class:"m-card m-login-card"},l={key:0,class:"m-card-main"},d={class:"m-card-form-label"},p={class:"m-card-form-value"},m={class:"m-card-form-label"},h={class:"u-resetpwd"},f=["href"],g={key:0},w={key:1,class:"m-card-main"},k=["href"],v={class:"m-footer"},b={class:"m-footer-skip"},$=["href"];function C(e,t,n,r,c,i){const C=(0,o.up)("lang-select"),_=(0,o.up)("card-header"),L=(0,o.up)("phone-code-select"),y=(0,o.up)("el-input"),P=(0,o.up)("el-form-item"),V=(0,o.up)("el-button"),W=(0,o.up)("el-form"),z=(0,o.up)("el-alert");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o._)("div",u,[(0,o.Wm)(_,{title:e.$t("account.common.login")},{right:(0,o.w5)((()=>[(0,o.Wm)(C,{lang:i.lang},null,8,["lang"])])),_:1},8,["title"]),c.success?((0,o.wg)(),(0,o.iD)("div",w,[(0,o.Wm)(z,{class:"m-alert",title:e.$t("account.common.loginSuccess"),type:"success",description:e.$t("account.common.loginSuccessDesc"),"show-icon":"",closable:!1},null,8,["title","description"]),(0,o._)("a",{class:"el-button u-btn el-button--primary u-skip",href:c.redirect},(0,s.zw)(c.redirect_button),9,k)])):((0,o.wg)(),(0,o.iD)("div",l,[(0,o.Wm)(W,{class:"m-card-form","hide-required-asterisk":"",ref:"loginForm","label-position":"top",model:c.form,rules:c.rules,size:"large"},{default:(0,o.w5)((()=>[(0,o.Wm)(P,{prop:"phone"},{label:(0,o.w5)((()=>[(0,o._)("div",d,[(0,o._)("span",null,(0,s.zw)(e.$t("account.phone.number")),1)])])),default:(0,o.w5)((()=>[(0,o._)("div",p,[(0,o.Wm)(L,{modelValue:c.phoneCode,"onUpdate:modelValue":t[0]||(t[0]=e=>c.phoneCode=e),size:"large"},null,8,["modelValue"]),(0,o.Wm)(y,{modelValue:c.form.phone,"onUpdate:modelValue":t[1]||(t[1]=e=>c.form.phone=e),modelModifiers:{trim:!0},size:"large",tabindex:"1"},null,8,["modelValue"])])])),_:1}),(0,o.Wm)(P,{prop:"code",class:"u-code"},{label:(0,o.w5)((()=>[(0,o._)("div",m,[(0,o._)("span",null,(0,s.zw)(e.$t("account.phone.code")),1),(0,o._)("span",h,[(0,o._)("a",{href:n.resetPwdLink},(0,s.zw)(e.$t("account.email.forgetPassword"))+"?",9,f)])])])),default:(0,o.w5)((()=>[(0,o.Wm)(y,{modelValue:c.form.code,"onUpdate:modelValue":t[2]||(t[2]=e=>c.form.code=e),modelModifiers:{trim:!0},onKeydown:(0,a.D2)(i.onLogin,["enter"]),size:"large",tabindex:"2"},null,8,["modelValue","onKeydown"]),(0,o.Wm)(V,{class:"u-btn-send",size:"small",onClick:i.senCode,disabled:c.interval>0||!c.phoneChecked},{default:(0,o.w5)((()=>[(0,o.Uk)((0,s.zw)(e.$t("account.email.send")),1),c.interval?((0,o.wg)(),(0,o.iD)("span",g,"("+(0,s.zw)(c.interval)+"s)",1)):(0,o.kq)("",!0)])),_:1},8,["onClick","disabled"])])),_:1})])),_:1},8,["model","rules"]),c.error?((0,o.wg)(),(0,o.j4)(z,{key:0,class:"u-alert",type:"error","show-icon":"",title:c.error},null,8,["title"])):(0,o.kq)("",!0),(0,o.Wm)(V,{class:"u-btn u-submit",type:"primary",onClick:i.onLogin,tabindex:"3"},{default:(0,o.w5)((()=>[(0,o.Uk)((0,s.zw)(e.$t("account.common.login")),1)])),_:1},8,["onClick"])]))]),(0,o._)("div",v,[(0,o._)("div",b,[(0,o.Uk)((0,s.zw)(e.$t("account.common.noAccount"))+" ",1),(0,o._)("a",{class:"u-link",href:n.registerLink},(0,s.zw)(e.$t("account.common.registerNow"))+" ðŸ‘‰",9,$)])])],64)}var _=n(2208),L=n(9158),y=n(9709),P={name:"PhoneCodeLogin",props:{app:{type:String,default:""},registerLink:{type:String,default:""},resetPwdLink:{type:String,default:""}},data(){return{form:{phone:"",code:""},phoneCode:86,rules:{phone:[{required:!0,message:this.$t("account.phone.numberPlaceholder"),trigger:"blur"},{validator:(e,t,n)=>{const o=`+${this.phoneCode}${t}`,r=(0,y.S)(o);r||(this.phoneChecked=!1,n(new Error(this.$t("account.phone.numberPlaceholder")))),r.isValid()?(this.phoneChecked=!0,n()):(this.phoneChecked=!1,n(new Error(this.$t("account.phone.numberError"))))},trigger:"blur"}],password:[{required:!0,message:this.$t("account.phone.codePlaceholder"),trigger:"blur"}]},error:"",success:!1,interval:0,timer:null,redirect:"",redirect_button:"",homepage:"/",phoneChecked:!1}},computed:{lang(){return L.Z.getLocale()}},mounted(){L.Z.generateFingerprint(),this.checkDirect()},methods:{onLogin(){this.error="",this.$refs.loginForm.validate((async e=>{if(e){const e={phone:`+${this.phoneCode}${this.form.phone}`,code:this.form.code};(0,_.Je)(e,{app:this.app}).then((e=>{this.$message.success(this.$t("account.common.loginSuccess")),this.success=!0,L.Z.update(e.data.data).then((()=>{this.skip()}))})).catch((e=>{var t;this.success=!1,this.error=(null===(t=e.data)||void 0===t?void 0:t.msg)||this.$t("account.phone.loginFailedWithPwd")}))}}))},senCode(){if(!this.form.phone)return;const e=`+${this.phoneCode}${this.form.phone}`;(0,_.UP)({phone:e},{app:this.app}).then((()=>{this.$message.success(this.$t("account.phone.sendSuccess")),this.interval=60,this.timer=setInterval((()=>{this.interval--,this.interval<=0&&clearInterval(this.timer)}),1e3)}))},checkDirect(){let e=new URLSearchParams(document.location.search),t=e.get("redirect");t?(this.redirect=t,this.redirect_button=this.$t("account.common.jump")):(this.redirect=this.homepage,this.redirect_button=this.$t("account.common.backToHome"))},skip(){this.redirect&&setTimeout((()=>{location.href=decodeURIComponent(this.redirect)}),1200)}}},V=n(3744);const W=(0,V.Z)(P,[["render",C]]);var z=W,D=n(650),U={name:"AccountCodePhoneLogin",components:{login:z,Footer:D.Z},data(){return{app:""}},computed:{registerLink(){const e=this.$router.resolve({name:"phone-register"});return e.href},resetPwdLink(){return""}},mounted(){const e=new URLSearchParams(document.location.search);e.has("app")?this.app=e.get("app"):this.app="miipet"}};const S=(0,V.Z)(U,[["render",i]]);var M=S}}]);
//# sourceMappingURL=156.0517523d.js.map