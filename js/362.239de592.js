"use strict";(self["webpackChunki"]=self["webpackChunki"]||[]).push([[362],{6430:function(e,o,i){i.d(o,{Z:function(){return _}});var n=i(6252),t=i(3577),a=i(9963);const l={class:"c-header"},s={class:"c-header_main"},r={class:"c-header-left"},d={key:0,class:"c-header__title"},c={key:1,class:"c-header__desc"},u={class:"c-header-right"},p={class:"c-header__profile"},h={class:"u-name"};function m(e,o,i,m,f,g){var k,w;const v=(0,n.up)("lang-select"),_=(0,n.up)("el-dropdown-item"),b=(0,n.up)("el-dropdown-menu"),$=(0,n.up)("el-dropdown");return(0,n.wg)(),(0,n.iD)("div",l,[(0,n._)("div",s,[(0,n._)("div",r,[null!==(k=g.routeMeta)&&void 0!==k&&k.title?((0,n.wg)(),(0,n.iD)("div",d,(0,t.zw)(g.routeMeta.title),1)):(0,n.kq)("",!0),null!==(w=g.routeMeta)&&void 0!==w&&w.desc?((0,n.wg)(),(0,n.iD)("div",c,(0,t.zw)(g.routeMeta.desc),1)):(0,n.kq)("",!0)]),(0,n._)("div",u,[(0,n.Wm)(v,{class:"c-header__lang",selected:"icon",onChange:g.onLangChange,lang:g.lang},null,8,["onChange","lang"]),(0,n.Wm)($,{trigger:"click"},{dropdown:(0,n.w5)((()=>[(0,n.Wm)(b,null,{default:(0,n.w5)((()=>[(0,n.Wm)(_,{onClick:(0,a.iM)(g.logout,["stop"])},{default:(0,n.w5)((()=>[(0,n.Uk)((0,t.zw)(e.$t("account.common.logout")),1)])),_:1},8,["onClick"])])),_:1})])),default:(0,n.w5)((()=>[(0,n._)("div",p,[(0,n._)("span",h,(0,t.zw)(g.profile.username||g.profile.nickname),1)])])),_:1})])])])}var f=i(9158),g=i(2878),k={name:"PageHeader",data:function(){return{}},computed:{routeMeta(){return this.$route.meta},profile(){return this.$store.state.user},avatar(){var e;return(null===(e=this.profile)||void 0===e?void 0:e.avatar)&&"null"!=this.profile.avatar||i(9743)},app(){return this.$store.state.app},lang(){return f.Z.getLocale()}},watch:{},methods:{logout(){(0,g.kS)().then((()=>{f.Z.logout(),this.$router.push({name:"email-login"})}))},onLangChange(e){(0,g.gS)({lang:e},{app:this.app}).then((()=>{location.reload()}))}}},w=i(3744);const v=(0,w.Z)(k,[["render",m]]);var _=v},4557:function(e,o,i){i.r(o),i.d(o,{default:function(){return q}});var n=i(6252),t=i(3577),a=i.p+"img/phone.4387bfee.svg";const l={class:"p-bind p-bind-phone"},s={class:"m-bind-phone m-bind-block"},r={class:"m-bind-block__main"},d={class:"u-header"},c={class:"u-slogan"},u={class:"m-current"},p={class:"u-current"},h={key:0,class:"u-status--success"},m={class:"u-bind-tips"},f={key:1,class:"m-login-card m-card-main"},g={class:"m-card-form-label"},k={class:"m-card-form-value"},w={class:"m-card-form-label"},v={key:0};function _(e,o,i,_,b,$){const C=(0,n.up)("page-header"),z=(0,n.up)("CircleCheckFilled"),W=(0,n.up)("el-icon"),E=(0,n.up)("el-button"),q=(0,n.up)("phone-code-select"),y=(0,n.up)("el-input"),U=(0,n.up)("el-form-item"),V=(0,n.up)("el-form"),D=(0,n.up)("ArrowLeftBold");return(0,n.wg)(),(0,n.iD)("div",l,[(0,n.Wm)(C),(0,n._)("div",s,[o[6]||(o[6]=(0,n._)("div",{class:"m-bind-block__pic"},[(0,n._)("img",{src:a})],-1)),(0,n._)("div",r,[(0,n._)("h1",d,(0,t.zw)(e.$t("notification.phone.bindPhone")),1),(0,n._)("div",c,(0,t.zw)(e.$t("notification.phone.bindPhoneAlert")),1),$.profile.phone&&!b.isEdit?((0,n.wg)(),(0,n.iD)(n.HY,{key:0},[(0,n._)("div",u,[(0,n.Uk)((0,t.zw)(e.$t("notification.phone.currentBind"))+": ",1),(0,n._)("span",p,(0,t.zw)($.profile.phone||e.$t("notification.phone.noBind")),1),$.profile.phone?((0,n.wg)(),(0,n.iD)("span",h,[(0,n.Wm)(W,null,{default:(0,n.w5)((()=>[(0,n.Wm)(z)])),_:1})])):(0,n.kq)("",!0)]),(0,n._)("div",m,(0,t.zw)(e.$t("account.common.accountBind")),1),(0,n.Wm)(E,{class:"u-edit-btn",onClick:$.onEditBind},{default:(0,n.w5)((()=>[(0,n.Uk)((0,t.zw)(e.$t("account.common.editBind")),1)])),_:1},8,["onClick"])],64)):(0,n.kq)("",!0),!$.profile.phone||b.isEdit?((0,n.wg)(),(0,n.iD)("div",f,[(0,n.Wm)(V,{class:"m-card-form","hide-required-asterisk":"",ref:"registerForm",model:b.form,rules:b.rules,size:"large","status-icon":"","label-position":"top"},{default:(0,n.w5)((()=>[(0,n.Wm)(U,{prop:"phone"},{label:(0,n.w5)((()=>[(0,n._)("div",g,[(0,n._)("span",null,[(0,n.Uk)((0,t.zw)(e.$t("notification.phone.number")),1),o[4]||(o[4]=(0,n._)("i",{class:"is-required"},"*",-1))])])])),default:(0,n.w5)((()=>[(0,n._)("div",k,[(0,n.Wm)(q,{modelValue:b.phoneCode,"onUpdate:modelValue":o[0]||(o[0]=e=>b.phoneCode=e),size:"large"},null,8,["modelValue"]),(0,n.Wm)(y,{modelValue:b.form.phone,"onUpdate:modelValue":o[1]||(o[1]=e=>b.form.phone=e),modelModifiers:{trim:!0},size:"large"},null,8,["modelValue"])])])),_:1}),(0,n.Wm)(U,{prop:"code",class:"u-code"},{label:(0,n.w5)((()=>[(0,n._)("div",w,[(0,n._)("span",null,[(0,n.Uk)((0,t.zw)(e.$t("notification.phone.code")),1),o[5]||(o[5]=(0,n._)("i",{class:"is-required"},"*",-1))])])])),default:(0,n.w5)((()=>[(0,n.Wm)(y,{modelValue:b.form.code,"onUpdate:modelValue":o[2]||(o[2]=e=>b.form.code=e),modelModifiers:{trim:!0},placeholder:e.$t("notification.phone.code"),size:"large"},null,8,["modelValue","placeholder"]),(0,n.Wm)(E,{class:"u-btn-send",size:"small",onClick:$.sendCode,disabled:b.interval>0||!b.phoneChecked},{default:(0,n.w5)((()=>[(0,n.Uk)((0,t.zw)(e.$t("notification.phone.send")),1),b.interval?((0,n.wg)(),(0,n.iD)("span",v,"("+(0,t.zw)(b.interval)+"s)",1)):(0,n.kq)("",!0)])),_:1},8,["onClick","disabled"])])),_:1})])),_:1},8,["model","rules"]),(0,n.Wm)(E,{type:"primary",size:"large",disabled:!b.form.phone||!b.form.code,onClick:$.submit,loading:b.loading,style:{width:"100%"}},{default:(0,n.w5)((()=>[(0,n.Uk)((0,t.zw)(e.$t("notification.phone.confirm")),1)])),_:1},8,["disabled","onClick","loading"]),b.isEdit?((0,n.wg)(),(0,n.iD)("a",{key:0,class:"u-back",onClick:o[3]||(o[3]=(...e)=>$.onCancelEdit&&$.onCancelEdit(...e))},[(0,n.Wm)(W,null,{default:(0,n.w5)((()=>[(0,n.Wm)(D)])),_:1}),(0,n.Uk)((0,t.zw)(e.$t("account.common.back")),1)])):(0,n.kq)("",!0)])):(0,n.kq)("",!0)])])])}var b=i(2878),$=i(9709),C=i(6430),z={name:"dashboard-bind-phone",components:{pageHeader:C.Z},props:{app:{type:String,default:"miipet"}},data(){return{form:{phone:"",code:""},phoneCode:86,rules:{phone:[{required:!0,message:this.$t("notification.phone.numberPlaceholder"),trigger:"blur"},{validator:(e,o,i)=>{const n=`+${this.phoneCode}${o}`;n===this.profile.phone&&(this.phoneChecked=!1,i(new Error(this.$t("notification.phone.sameError"))));const t=(0,$.S)(n);t&&null!==t&&void 0!==t&&t.isValid()?(this.phoneChecked=!0,i()):(this.phoneChecked=!1,i(new Error(this.$t("notification.phone.numberError"))))},trigger:"blur"}],code:[{required:!0,message:this.$t("notification.phone.codePlaceholder"),trigger:"blur"}]},interval:0,phoneChecked:!1,loading:!1,isEdit:!1}},computed:{profile(){return this.$store.state.user}},methods:{sendCode(){(0,b.dX)({phone:`+${this.phoneCode}${this.form.phone}`},{app:this.app}).then((()=>{this.$message.success(this.$t("notification.phone.sendSuccess")),this.interval=60;const e=setInterval((()=>{this.interval--,this.interval<=0&&clearInterval(e)}),1e3)}))},submit(){this.$refs.registerForm.validate((e=>{if(e){this.loading=!0;const e={phone:`+${this.phoneCode}${this.form.phone}`,code:this.form.code};(0,b.tW)(e).then((()=>{(0,b.Jl)(e,{app:this.app}).then((()=>{this.$message.success(this.$t("account.common.bindSuccess")),this.$store.dispatch("getProfile")})).finally((()=>{this.loading=!1}))})).catch((()=>{this.loading=!1}))}}))},onEditBind(){this.isEdit=!0},onCancelEdit(){this.isEdit=!1}}},W=i(3744);const E=(0,W.Z)(z,[["render",_]]);var q=E},9743:function(e,o,i){e.exports=i.p+"img/test.2ffd992c.png"}}]);
//# sourceMappingURL=362.239de592.js.map